(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e3892f0"],{1218:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Comment"),a("Pagination")],1)},i=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[-1===t.parentCommentId?a("CommentForm"):t._e(),a("h3",{staticClass:"ui dividing header"},[t._v("Comments | 共 "+t._s(t.allComment)+" 条评论"),0!==t.closeComment?a("span",[t._v("（"+t._s(t.closeComment)+" 条评论被隐藏）")]):t._e()]),0===t.allComment?a("h3",{staticClass:"ui header"},[t._v("这是沙发，请抢！")]):t._e(),t._l(t.comments,(function(e){return a("div",{key:e.id,staticClass:"comment"},[a("span",{staticClass:"anchor",attrs:{id:"comment-"+e.id}}),a("a",{staticClass:"ui circular image avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"content"},[a("a",{staticClass:"nickname",attrs:{href:""!=e.website&&null!=e.website?e.website:null,target:"_blank",rel:"external nofollow noopener"}},[t._v(t._s(e.nickname))]),e.adminComment?a("div",{staticClass:"ui orange left pointing label"},[t._v(t._s(t.$store.state.siteInfo.commentAdminFlag))]):t._e(),a("div",{staticClass:"metadata"},[a("strong",{staticClass:"date"},[t._v(t._s(t._f("dateFormat")(e.createTime,"YYYY-MM-DD HH:mm")))])]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.setReply(e.id)}}},[t._v("回复")]),a("div",{staticClass:"text",domProps:{innerHTML:t._s(e.content)}})],1),e.replyComments.length>0?a("div",{staticClass:"comments"},t._l(e.replyComments,(function(e){return a("div",{key:e.id,staticClass:"comment"},[a("span",{staticClass:"anchor",attrs:{id:"comment-"+e.id}}),a("a",{staticClass:"ui circular image avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"content"},[a("a",{staticClass:"nickname",attrs:{href:""!=e.website&&null!=e.website?e.website:null,target:"_blank",rel:"external nofollow noopener"}},[t._v(t._s(e.nickname))]),e.adminComment?a("div",{staticClass:"ui orange left pointing label"},[t._v(t._s(t.$store.state.siteInfo.commentAdminFlag))]):t._e(),a("div",{staticClass:"metadata"},[a("strong",{staticClass:"date"},[t._v(t._s(t._f("dateFormat")(e.createTime,"YYYY-MM-DD HH:mm")))])]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.setReply(e.id)}}},[t._v("回复")]),a("div",{staticClass:"text"},[a("a",{attrs:{href:"#comment-"+e.parentCommentId}},[t._v("@"+t._s(e.parentCommentNickname))]),a("div",{domProps:{innerHTML:t._s(e.content)}})])],1),t.parentCommentId===e.id?a("CommentForm"):t._e()],1)})),0):t._e(),a("div",{staticClass:"border"}),t.parentCommentId===e.id?a("CommentForm"):t._e()],1)}))],2)},n=[],r=a("2f62"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form"},[a("h3",[t._v(" 发表评论 "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!==t.parentCommentId,expression:"parentCommentId!==-1"}],staticClass:"m-small",attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.$store.commit(t.SET_PARENT_COMMENT_ID,-1)}}},[t._v("取消回复")])],1),a("el-form",{ref:"formRef",attrs:{inline:!0,model:t.commentForm,rules:t.formRules,size:"small"}},[a("el-input",{class:"textarea",attrs:{type:"textarea",rows:5,placeholder:"......尝试留下一些足迹...",maxlength:"200","show-word-limit":"","validate-event":!1},model:{value:t.commentForm.content,callback:function(e){t.$set(t.commentForm,"content",e)},expression:"commentForm.content"}}),a("div",{staticClass:"el-form-item el-form-item--small emoji"},[a("img",{attrs:{src:"https://cdn.naccl.top/blog/img/tv/24.png",width:"36px",height:"36px"},on:{click:t.showEmojiBox}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.emojiShow,expression:"emojiShow"}],staticClass:"mask",on:{click:t.hideEmojiBox}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.emojiShow,expression:"emojiShow"}],staticClass:"emoji-box"},[a("div",{staticClass:"emoji-title"},[a("span",[t._v(t._s(0===t.activeEmojiTab?"tv_小电视":1===t.activeEmojiTab?"阿鲁":"泡泡"))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.activeEmojiTab,expression:"activeEmojiTab===0"}],staticClass:"emoji-wrap"},t._l(t.tvMapper,(function(e,s){return a("div",{key:s,staticClass:"emoji-list",on:{click:function(a){return t.insertEmoji(e.name)}}},[a("img",{attrs:{src:e.src,title:e.name}})])})),0),a("div",{staticClass:"emoji-tabs"},[a("a",{staticClass:"tab-link",class:{on:0===t.activeEmojiTab},on:{click:function(e){t.activeEmojiTab=0}}},[a("img",{attrs:{src:"https://cdn.naccl.top/blog/img/tv/1.png"}})])])])]),a("el-form-item",{attrs:{prop:"nickname"}},[a("el-input",{directives:[{name:"popover",rawName:"v-popover:nicknamePopover",arg:"nicknamePopover"}],attrs:{placeholder:"昵称（必填）","validate-event":!1},model:{value:t.commentForm.nickname,callback:function(e){t.$set(t.commentForm,"nickname",e)},expression:"commentForm.nickname"}},[a("i",{staticClass:"el-input__icon el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-form-item",{attrs:{prop:"email"}},[a("el-popover",{ref:"emailPopover",attrs:{placement:"bottom",trigger:"focus",content:"用于接收回复邮件"}}),a("el-input",{directives:[{name:"popover",rawName:"v-popover:emailPopover",arg:"emailPopover"}],attrs:{placeholder:"邮箱（必填）","validate-event":!1},model:{value:t.commentForm.email,callback:function(e){t.$set(t.commentForm,"email",e)},expression:"commentForm.email"}},[a("i",{staticClass:"el-input__icon el-icon-message",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-form-item",{attrs:{prop:"website"}},[a("el-popover",{ref:"websitePopover",attrs:{placement:"bottom",trigger:"focus",content:"看看你的"}}),a("el-input",{directives:[{name:"popover",rawName:"v-popover:websitePopover",arg:"websitePopover"}],attrs:{placeholder:"https://（可选）","validate-event":!1},model:{value:t.commentForm.website,callback:function(e){t.$set(t.commentForm,"website",e)},expression:"commentForm.website"}},[a("i",{staticClass:"el-input__icon el-icon-map-location",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-form-item",{attrs:{label:"订阅回复"}},[a("el-switch",{model:{value:t.commentForm.notice,callback:function(e){t.$set(t.commentForm,"notice",e)},expression:"commentForm.notice"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"throttle",rawName:"v-throttle",value:[t.postForm,"click",3e3],expression:"[postForm,`click`,3000]"}],attrs:{type:"primary",size:"medium"}},[t._v("发表评论")])],1)],1)],1)},c=[];const l=(t,e,a)=>{const s=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(s.test(e))return a();a(new Error("请输入合法的邮箱"))},d=(t,e,a)=>{const s=/^https?:\/\/([^!@#$%^&*?.\s-]([^!@#$%^&*?.\s]{0,63}[^!@#$%^&*?.\s])?\.)+[a-z]{2,6}\/?/;if(s.test(e))return a();a(new Error("请输入合法的 URL"))};var u=a("4ba1"),p=a("1d41"),h=a("3494"),v=a("848a");const g=(t,e,a)=>{if(e)return d(t,e,a);a()};var b={name:"CommentForm",computed:{...Object(r["b"])(["parentCommentId","commentForm","commentQuery"])},data(){return{SET_PARENT_COMMENT_ID:u["o"],formRules:{nickname:[{required:!0,message:"请输入评论昵称"},{max:18,message:"昵称不可多于15个字符"}],email:[{required:!0,message:"请输入评论邮箱"},{validator:l}],website:[{required:!1},{validator:g}]},emojiShow:!1,activeEmojiTab:0,tvMapper:[],aruMapper:[],paopaoMapper:[],textarea:null,start:0,end:0}},created(){this.tvMapper=p,this.aruMapper=h,this.paopaoMapper=v},mounted(){this.textarea=document.querySelector(".el-form textarea")},methods:{showEmojiBox(){this.start=this.textarea.selectionStart,this.end=this.textarea.selectionEnd,this.textarea.focus(),this.textarea.setSelectionRange(this.start,this.end),this.emojiShow=!this.emojiShow},insertEmoji(t){let e=this.commentForm.content;this.commentForm.content=e.substring(0,this.start)+t+e.substring(this.end),this.start+=t.length,this.end=this.start,this.textarea.focus(),this.$nextTick(()=>{this.textarea.setSelectionRange(this.start,this.end)})},hideEmojiBox(){this.emojiShow=!1,this.textarea.focus(),this.textarea.setSelectionRange(this.start,this.end)},postForm(){const t=window.localStorage.getItem("adminToken");if(t)return""===this.commentForm.content||this.commentForm.content.length>200?this.$notify({title:"评论失败",message:"评论内容有误",type:"warning"}):this.$store.dispatch("submitCommentForm",t);const e=window.localStorage.getItem("blog"+this.commentQuery.blogId);this.$refs.formRef.validate(t=>{!t||""===this.commentForm.content||this.commentForm.content.length>200?this.$notify({title:"评论失败",message:"请正确填写评论",type:"warning"}):this.$store.dispatch("submitCommentForm",e||"")})}}},f=b,C=(a("8f75"),a("2877")),_=Object(C["a"])(f,m,c,!1,null,null,null),w=_.exports,k={name:"Comment",components:{CommentForm:w},computed:{...Object(r["b"])(["allComment","closeComment","comments","parentCommentId"])},methods:{setReply(t){this.$store.commit(u["o"],t)}}},x=k,F=(a("422e"),Object(C["a"])(x,o,n,!1,null,"4ce50154",null)),$=F.exports,j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.commentQuery.pageNum,"page-count":t.commentTotalPage,layout:"prev, pager, next",background:"","hide-on-single-page":""},on:{"current-change":t.handleCurrentChange}})},y=[],E={name:"Pagination",computed:{...Object(r["b"])(["commentQuery","commentTotalPage"])},methods:{handleCurrentChange(t){this.$store.commit(u["k"],t),this.$store.commit(u["o"],-1),this.$store.dispatch("getCommentList")}}},T=E,M=(a("fa77"),Object(C["a"])(T,j,y,!1,null,"5bc58a75",null)),I=M.exports,S={name:"CommentList",components:{Comment:$,Pagination:I},props:{page:{type:Number,required:!0},blogId:{type:Number,required:!1}},created(){this.init()},watch:{"$route.path"(){this.init()}},methods:{init(){this.$store.commit(u["o"],-1),this.$store.commit(u["j"],this.page),this.$store.commit(u["i"],this.blogId),this.$store.commit(u["k"],1),this.$store.dispatch("getCommentList")}}},P=S,Y=Object(C["a"])(P,s,i,!1,null,"d0718afc",null);e["a"]=Y.exports},"195e":function(t,e,a){},"422e":function(t,e,a){"use strict";a("b597")},"43e0":function(t,e,a){},"66ba":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ui padded attached segment m-padded-tb-large"},[t.blog.top?a("div",{staticClass:"ui large red right corner label"},[a("i",{staticClass:"arrow alternate circle up icon"})]):t._e(),a("div",{staticClass:"ui middle aligned mobile reversed stackable"},[a("div",{staticClass:"ui grid m-margin-lr"},[a("div",{staticClass:"row m-padded-tb-small"},[a("h2",{staticClass:"ui header m-center"},[t._v(t._s(t.blog.title))])]),a("div",{staticClass:"row m-padded-tb-small"},[a("div",{staticClass:"ui horizontal link list m-center"},[a("div",{staticClass:"item m-datetime"},[a("i",{staticClass:"small calendar icon"}),a("span",[t._v(t._s(t._f("dateFormat")(t.blog.createTime,"YYYY-MM-DD")))])]),a("div",{staticClass:"item m-views"},[a("i",{staticClass:"small eye icon"}),a("span",[t._v(t._s(t.blog.views))])]),a("div",{staticClass:"item m-common-black"},[a("i",{staticClass:"small pencil alternate icon"}),a("span",[t._v("字数≈"+t._s(t.blog.words)+"字")])]),a("div",{staticClass:"item m-common-black"},[a("i",{staticClass:"small clock icon"}),a("span",[t._v("阅读时长≈"+t._s(t.blog.readTime)+"分")])]),a("a",{staticClass:"item m-common-black",on:{click:function(e){e.preventDefault(),t.bigFontSize=!t.bigFontSize}}},[t._m(0)]),a("a",{staticClass:"item m-common-black",on:{click:function(e){return e.preventDefault(),t.changeFocusMode(e)}}},[t._m(1)])])]),t.blog.category?a("router-link",{staticClass:"ui orange large ribbon label",attrs:{to:"/category/"+t.blog.category.name}},[a("i",{staticClass:"small folder open icon"}),a("span",{staticClass:"m-text-500"},[t._v(t._s(t.blog.category.name))])]):t._e(),a("div",{directives:[{name:"lazy-container",rawName:"v-lazy-container",value:{selector:"img"},expression:"{selector: 'img'}"},{name:"viewer",rawName:"v-viewer"}],staticClass:"typo js-toc-content m-padded-tb-small match-braces rainbow-braces",class:{"m-big-fontsize":t.bigFontSize},domProps:{innerHTML:t._s(t.blog.content)}}),a("el-divider"),a("div",{staticClass:"row m-padded-tb-no"},[a("div",{staticClass:"column m-padding-left-no"},t._l(t.blog.tags,(function(e,s){return a("router-link",{key:s,staticClass:"ui tag label m-text-500 m-margin-small",class:e.color,attrs:{to:"/tag/"+e.name}},[t._v(t._s(e.name))])})),1)])],1)])]),a("div",{staticClass:"ui attached positive message"},[a("ul",{staticClass:"list"},[a("li",[t._v("作者："+t._s(t.$store.state.introduction.name)+" "),a("router-link",{attrs:{to:"/about"}},[t._v("（联系作者）")])],1),a("li",[t._v("发表时间："+t._s(t._f("dateFormat")(t.blog.createTime,"YYYY-MM-DD HH:mm")))]),a("li",[t._v("最后修改："+t._s(t._f("dateFormat")(t.blog.updateTime,"YYYY-MM-DD HH:mm")))])])]),a("div",{staticClass:"ui bottom teal attached segment threaded comments"},[t.blog.commentEnabled?a("CommentList",{attrs:{page:0,blogId:t.blogId}}):a("h3",{staticClass:"ui header"},[t._v("评论已关闭")])],1)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{"data-inverted":"","data-tooltip":"点击切换字体大小","data-position":"top center"}},[a("i",{staticClass:"font icon"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{"data-inverted":"","data-tooltip":"专注模式","data-position":"top center"}},[a("i",{staticClass:"book icon"})])}],o=a("864d"),n=a("1218"),r=a("2f62"),m=a("4ba1"),c={name:"Blog",components:{CommentList:n["a"]},data(){return{blog:{},bigFontSize:!1}},computed:{blogId(){return parseInt(this.$route.params.id)},...Object(r["b"])(["siteInfo","focusMode"])},beforeRouteEnter(t,e,a){a(t=>{t.$store.commit(m["m"],!1)})},beforeRouteLeave(t,e,a){this.$store.commit(m["l"],!1),tocbot.destroy(),a()},beforeRouteUpdate(t,e,a){t.path!==e.path&&(this.$store.commit(m["l"],!1),this.getBlog(t.params.id),this.$store.commit(m["m"],!1),a())},created(){this.getBlog()},methods:{getBlog(t=this.blogId){const e=window.localStorage.getItem("blog"+t),a=window.localStorage.getItem("adminToken"),s=a||(e||"");Object(o["b"])(s,t).then(t=>{200===t.code?(this.blog=t.data,document.title=this.blog.title+this.siteInfo.webTitleSuffix,this.$nextTick(()=>{Prism.highlightAll(),this.$store.commit(m["m"],!0)})):this.msgError(t.msg)}).catch(()=>{this.msgError("请求失败")})},changeFocusMode(){this.$store.commit(m["l"],!this.focusMode)}}},l=c,d=(a("f22c"),a("2877")),u=Object(d["a"])(l,s,i,!1,null,"64bb8296",null);e["default"]=u.exports},"864d":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return n}));var s=a("be3b");function i(t,e){return Object(s["a"])({url:"blog",method:"GET",headers:{Authorization:t},params:{id:e}})}function o(t){return Object(s["a"])({url:"checkBlogPassword",method:"POST",data:{...t}})}function n(t){return Object(s["a"])({url:"searchBlog",method:"GET",params:{query:t}})}},"8f75":function(t,e,a){"use strict";a("195e")},b597:function(t,e,a){},e07e:function(t,e,a){},f22c:function(t,e,a){"use strict";a("e07e")},fa77:function(t,e,a){"use strict";a("43e0")}}]);
//# sourceMappingURL=chunk-2e3892f0.21227160.js.map